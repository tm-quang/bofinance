# Implementation Plan: NÃ¢ng Cáº¥p "Sáº¡c Pin & NhiÃªn Liá»‡u"

## ğŸ“‹ Tá»•ng Quan

NÃ¢ng cáº¥p trang "Quáº£n lÃ½ nhiÃªn liá»‡u" thÃ nh "Sáº¡c pin & NhiÃªn liá»‡u" vá»›i cÃ¡c tÃ­nh nÄƒng:
- 2 tabs riÃªng biá»‡t cho XÄƒng/Dáº§u vÃ  Äiá»‡n
- Upload áº£nh hÃ³a Ä‘Æ¡n
- CÃ i Ä‘áº·t giÃ¡ nhiÃªn liá»‡u/Ä‘iá»‡n
- Tá»± Ä‘á»™ng tÃ­nh tiá»n

## ğŸ¯ YÃªu Cáº§u Chi Tiáº¿t

### 1. Äá»•i TÃªn Trang
- Hiá»‡n táº¡i: "QUáº¢N LY NHIÃŠN LIá»†U"
- Má»›i: "Sáº C PIN & NHIÃŠN LIá»†U"

### 2. Cáº¥u TrÃºc 2 Tabs

**Tab 1: XÄƒng/Dáº§u**
- MÃ u chá»§ Ä‘á»: XÃ¡m (gray-500, gray-600)
- Loáº¡i nhiÃªn liá»‡u:
  - XÄƒng A95
  - XÄƒng E5
  - Dáº§u Diesel
- TrÆ°á»ng dá»¯ liá»‡u:
  - NgÃ y/giá»
  - Loáº¡i nhiÃªn liá»‡u
  - Sá»‘ lÃ­t
  - ÄÆ¡n giÃ¡ (VND/lÃ­t)
  - Tá»•ng tiá»n (tá»± Ä‘á»™ng tÃ­nh)
  - Odometer
  - Äá»‹a Ä‘iá»ƒm
  - áº¢nh hÃ³a Ä‘Æ¡n
  - Ghi chÃº

**Tab 2: Äiá»‡n**
- MÃ u chá»§ Ä‘á»: Green-600
- TrÆ°á»ng dá»¯ liá»‡u:
  - NgÃ y/giá»
  - Sá»‘ kWh
  - ÄÆ¡n giÃ¡ (VND/kWh)
  - Tá»•ng tiá»n (tá»± Ä‘á»™ng tÃ­nh)
  - Odometer
  - Äá»‹a Ä‘iá»ƒm
  - áº¢nh hÃ³a Ä‘Æ¡n
  - Ghi chÃº

### 3. Chá»©c NÄƒng Upload áº¢nh
- Chá»¥p áº£nh tá»« camera (mobile)
- Chá»n áº£nh tá»« thÆ° viá»‡n
- Preview áº£nh trÆ°á»›c khi lÆ°u
- Upload lÃªn Cloudinary
- Hiá»ƒn thá»‹ thumbnail trong danh sÃ¡ch
- Xem áº£nh full size khi click

### 4. CÃ i Äáº·t GiÃ¡
- Modal cÃ i Ä‘áº·t giÃ¡ nhiÃªn liá»‡u
- LÆ°u vÃ o database
- Tá»± Ä‘á»™ng Ä‘iá»n giÃ¡ khi thÃªm má»›i
- Lá»‹ch sá»­ thay Ä‘á»•i giÃ¡

**GiÃ¡ máº·c Ä‘á»‹nh:**
- XÄƒng A95: 25,000 VND/lÃ­t
- XÄƒng E5: 23,000 VND/lÃ­t
- Dáº§u Diesel: 21,000 VND/lÃ­t
- Äiá»‡n: 3,000 VND/kWh

### 5. Tá»± Äá»™ng TÃ­nh Tiá»n
- CÃ´ng thá»©c: Tá»•ng tiá»n = Sá»‘ lÆ°á»£ng Ã— ÄÆ¡n giÃ¡
- Cáº­p nháº­t real-time khi nháº­p
- Hiá»ƒn thá»‹ dáº¡ng tiá»n tá»‡ (Ä‘)

## ğŸ—ï¸ Cáº¥u TrÃºc Database

### Báº£ng: fuel_price_settings
```sql
CREATE TABLE fuel_price_settings (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id) NOT NULL,
  fuel_type VARCHAR(50) NOT NULL, -- 'petrol_a95', 'petrol_e5', 'diesel', 'electric'
  price DECIMAL(10, 2) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, fuel_type)
);

-- Index
CREATE INDEX idx_fuel_price_user ON fuel_price_settings(user_id);

-- RLS Policies
ALTER TABLE fuel_price_settings ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own prices"
  ON fuel_price_settings FOR SELECT
  USING (auth.uid() = user_id);

CREATE POLICY "Users can insert own prices"
  ON fuel_price_settings FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own prices"
  ON fuel_price_settings FOR UPDATE
  USING (auth.uid() = user_id);

CREATE POLICY "Users can delete own prices"
  ON fuel_price_settings FOR DELETE
  USING (auth.uid() = user_id);
```

### Cáº­p nháº­t báº£ng: vehicle_fuel_logs
```sql
-- ThÃªm cá»™t má»›i
ALTER TABLE vehicle_fuel_logs 
ADD COLUMN IF NOT EXISTS fuel_category VARCHAR(20) DEFAULT 'fuel', -- 'fuel' hoáº·c 'electric'
ADD COLUMN IF NOT EXISTS unit_price DECIMAL(10, 2),
ADD COLUMN IF NOT EXISTS total_cost DECIMAL(10, 2),
ADD COLUMN IF NOT EXISTS receipt_image_url TEXT;

-- Index
CREATE INDEX IF NOT EXISTS idx_fuel_logs_category ON vehicle_fuel_logs(fuel_category);
CREATE INDEX IF NOT EXISTS idx_fuel_logs_vehicle ON vehicle_fuel_logs(vehicle_id);

-- Comment
COMMENT ON COLUMN vehicle_fuel_logs.fuel_category IS 'Category: fuel (xÄƒng/dáº§u) or electric (Ä‘iá»‡n)';
COMMENT ON COLUMN vehicle_fuel_logs.unit_price IS 'Price per unit (VND/lÃ­t hoáº·c VND/kWh)';
COMMENT ON COLUMN vehicle_fuel_logs.total_cost IS 'Total cost = quantity * unit_price';
COMMENT ON COLUMN vehicle_fuel_logs.receipt_image_url IS 'Cloudinary URL of receipt image';
```

## ğŸ“ Files Cáº§n Táº¡o/Sá»­a

### 1. Services

#### `src/lib/vehicles/fuelPriceService.ts` (Má»šI)
```typescript
// Functions:
export async function getFuelPrice(fuelType: string): Promise<number>
export async function updateFuelPrice(fuelType: string, price: number): Promise<void>
export async function getAllFuelPrices(): Promise<Record<string, number>>
export async function getDefaultPrice(fuelType: string): Promise<number>
```

### 2. Components

#### `src/components/vehicles/ImageUpload.tsx` (Má»šI)
```typescript
// Upload áº£nh vá»›i preview vÃ  camera
// Props:
interface ImageUploadProps {
  value: string | null
  onChange: (url: string | null) => void
  label?: string
  maxSize?: number // MB
}
```

#### `src/components/vehicles/FuelPriceSettings.tsx` (Má»šI)
```typescript
// Modal cÃ i Ä‘áº·t giÃ¡ nhiÃªn liá»‡u
// Props:
interface FuelPriceSettingsProps {
  isOpen: boolean
  onClose: () => void
  onSave: () => void
}
```

### 3. Pages

#### `src/pages/vehicles/VehicleFuel.tsx` (Cáº¬P NHáº¬T)
**Thay Ä‘á»•i chÃ­nh:**
1. Äá»•i title thÃ nh "Sáº C PIN & NHIÃŠN LIá»†U"
2. ThÃªm tabs UI (XÄƒng/Dáº§u, Äiá»‡n)
3. State cho active tab
4. Filter logs theo fuel_category
5. MÃ u sáº¯c conditional theo tab
6. TÃ­ch há»£p ImageUpload component
7. TÃ­ch há»£p FuelPriceSettings modal
8. Auto-load giÃ¡ tá»« settings
9. Auto-calculate total_cost
10. Hiá»ƒn thá»‹ thumbnail áº£nh trong list

## ğŸ¨ UI/UX Design

### Layout Structure
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Sáº C PIN & NHIÃŠN LIá»†U    [âš™ï¸]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Chá»n xe]                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚ XÄƒng/Dáº§u  â”‚   Äiá»‡n    â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š Tá»•ng quan                        â”‚
â”‚ Tá»•ng chi phÃ­: 1,500,000 Ä‘          â”‚
â”‚ Tá»•ng lÆ°á»£ng: 60 lÃ­t / 100 kWh       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ ThÃªm nháº­t kÃ½ má»›i]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ Danh sÃ¡ch                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 04/01/2026  XÄƒng A95            â”‚ â”‚
â”‚ â”‚ 10 lÃ­t Ã— 25,000Ä‘ = 250,000Ä‘     â”‚ â”‚
â”‚ â”‚ ğŸ“ Petrolimex HÃ  Ná»™i            â”‚ â”‚
â”‚ â”‚ ğŸ“· [Thumbnail]                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Add Modal Structure
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ThÃªm nháº­t kÃ½ - XÄƒng/Dáº§u        [x] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NgÃ y          â”‚ Giá»                 â”‚
â”‚ 04/01/2026    â”‚ 14:30               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Loáº¡i nhiÃªn liá»‡u                     â”‚
â”‚ â—‹ XÄƒng A95  â—‹ XÄƒng E5  â—‹ Dáº§u       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sá»‘ lÃ­t                              â”‚
â”‚ [10] lÃ­t                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ÄÆ¡n giÃ¡                             â”‚
â”‚ [25,000] Ä‘/lÃ­t                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’° Tá»•ng tiá»n: 250,000 Ä‘            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Odometer                            â”‚
â”‚ [120050] km                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Äá»‹a Ä‘iá»ƒm                            â”‚
â”‚ [Petrolimex...]                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“· áº¢nh hÃ³a Ä‘Æ¡n                      â”‚
â”‚ [ğŸ“· Chá»¥p áº£nh] [ğŸ“ Chá»n áº£nh]        â”‚
â”‚ [Preview náº¿u cÃ³ áº£nh]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ghi chÃº                             â”‚
â”‚ [...]                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ThÃªm nháº­t kÃ½]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Color Scheme

**Tab XÄƒng/Dáº§u (Active):**
```css
background: gray-500
text: white
border: gray-600
card-accent: border-l-4 border-l-gray-500
button: bg-gradient-to-r from-gray-500 to-gray-600
```

**Tab Äiá»‡n (Active):**
```css
background: green-600
text: white  
border: green-700
card-accent: border-l-4 border-l-green-600
button: bg-gradient-to-r from-green-500 to-green-600
```

## ğŸ”¨ Implementation Steps

### Phase 1: Database Migration â±ï¸ 30 min
1. âœ… Táº¡o báº£ng `fuel_price_settings`
2. âœ… ThÃªm cá»™t vÃ o `vehicle_fuel_logs`
3. âœ… Táº¡o indexes
4. âœ… Setup RLS policies
5. âœ… Cháº¡y migration trong Supabase

### Phase 2: Services â±ï¸ 1 hour
1. âœ… Táº¡o `fuelPriceService.ts`
   - getFuelPrice
   - updateFuelPrice  
   - getAllFuelPrices
   - getDefaultPrice

2. âœ… Cáº­p nháº­t `vehicleService.ts`
   - ThÃªm fields má»›i vÃ o createFuelLog
   - ThÃªm fields má»›i vÃ o FuelLogRecord type
   - Filter theo fuel_category

### Phase 3: Image Upload Component â±ï¸ 1.5 hours
1. âœ… Táº¡o `ImageUpload.tsx`
   - File input vá»›i accept="image/*"
   - Camera capture cho mobile
   - Image preview
   - Compress image trÆ°á»›c upload
   - Upload to Cloudinary
   - Loading state
   - Error handling
   - Delete uploaded image

### Phase 4: Price Settings Component â±ï¸ 45 min
1. âœ… Táº¡o `FuelPriceSettings.tsx`
   - Modal UI
   - Form inputs cho má»—i loáº¡i nhiÃªn liá»‡u
   - Load giÃ¡ hiá»‡n táº¡i
   - Save giÃ¡ má»›i
   - Validation
   - Success/error notifications

### Phase 5: Update VehicleFuel Page â±ï¸ 2 hours
1. âœ… UI Updates
   - Äá»•i title header
   - ThÃªm tabs UI (XÄƒng/Dáº§u, Äiá»‡n)
   - Icon cÃ i Ä‘áº·t giÃ¡
   - Conditional colors theo tab

2. âœ… State Management
   - activeTab state
   - Filter logs theo category
   - Load fuel prices on mount

3. âœ… Form Updates
   - ThÃªm ImageUpload
   - Load price khi chá»n fuel type
   - Auto-calculate total_cost
   - Conditional fields theo category

4. âœ… Display Updates
   - Hiá»ƒn thá»‹ thumbnail áº£nh
   - Click xem áº£nh full size
   - Hiá»ƒn thá»‹ total_cost
   - Tab-specific statistics

### Phase 6: Testing â±ï¸ 1 hour
1. âœ… Test upload áº£nh (camera + file picker)
2. âœ… Test cÃ i Ä‘áº·t giÃ¡
3. âœ… Test tÃ­nh tiá»n tá»± Ä‘á»™ng
4. âœ… Test tabs switching
5. âœ… Test filter logs
6. âœ… Test responsive mobile
7. âœ… Test data persistence

## ğŸ“Š Data Flow Diagrams

### Flow 1: ThÃªm Nháº­t KÃ½ XÄƒng/Dáº§u
```
User â†’ Chá»n tab "XÄƒng/Dáº§u"
     â†’ Set fuel_category = 'fuel'
     â†’ Chá»n loáº¡i (A95/E5/Diesel)
     â†’ Load unit_price tá»« fuel_price_settings
     â†’ Nháº­p quantity
     â†’ Auto calculate: total_cost = quantity Ã— unit_price
     â†’ Chá»¥p/chá»n áº£nh
     â†’ Compress + Upload to Cloudinary
     â†’ Get receipt_image_url
     â†’ Submit form
     â†’ Save to vehicle_fuel_logs vá»›i:
        - fuel_category: 'fuel'
        - fuel_type: 'petrol_a95'
        - quantity: 10
        - unit_price: 25000
        - total_cost: 250000
        - receipt_image_url: 'https://...'
```

### Flow 2: CÃ i Äáº·t GiÃ¡
```
User â†’ Click icon âš™ï¸
     â†’ Open FuelPriceSettings modal
     â†’ Load current prices tá»« fuel_price_settings
     â†’ Edit prices
     â†’ Click Save
     â†’ UPSERT into fuel_price_settings
     â†’ Invalidate queries
     â†’ Refresh prices trong form
     â†’ Show success notification
```

### Flow 3: Xem áº¢nh HÃ³a ÄÆ¡n
```
User â†’ Click thumbnail trong log list
     â†’ Open full image modal
     â†’ Display full size image
     â†’ Option to close
```

## ğŸ” Security & Validation

### Validation Rules
```typescript
// Quantity
min: 0.1
max: 1000
decimal places: 2

// Unit Price
min: 100
max: 100000
decimal places: 0

// Image
max size: 5MB
allowed types: ['image/jpeg', 'image/png', 'image/webp']
max dimensions: 4096Ã—4096

// Fuel Type
allowed values: ['petrol_a95', 'petrol_e5', 'diesel', 'electric']
```

### Error Messages
- "Sá»‘ lÆ°á»£ng pháº£i lá»›n hÆ¡n 0"
- "ÄÆ¡n giÃ¡ khÃ´ng há»£p lá»‡"
- "áº¢nh quÃ¡ lá»›n, vui lÃ²ng chá»n áº£nh dÆ°á»›i 5MB"
- "Äá»‹nh dáº¡ng áº£nh khÃ´ng Ä‘Æ°á»£c há»— trá»£"
- "KhÃ´ng thá»ƒ upload áº£nh, vui lÃ²ng thá»­ láº¡i"

## ğŸ“± Mobile Optimization

### Camera Integration
```html
<!-- Mobile: Open camera trá»±c tiáº¿p -->
<input 
  type="file" 
  accept="image/*" 
  capture="environment"
/>

<!-- Desktop: File picker -->
<input 
  type="file" 
  accept="image/*"
/>
```

### Image Compression
```typescript
// Resize náº¿u lá»›n hÆ¡n 1920px
maxWidth: 1920
maxHeight: 1920
quality: 0.8
format: 'jpeg'
```

### Touch Optimization
- Button min height: 44px
- Tab min width: 120px
- Touch targets spacing: 8px
- Swipe Ä‘á»ƒ chuyá»ƒn tab
- Pull-to-refresh

## ğŸ¯ Success Criteria

### Must Have
- âœ… 2 tabs hoáº¡t Ä‘á»™ng (XÄƒng/Dáº§u, Äiá»‡n)
- âœ… Upload áº£nh hÃ³a Ä‘Æ¡n
- âœ… CÃ i Ä‘áº·t giÃ¡ nhiÃªn liá»‡u
- âœ… Tá»± Ä‘á»™ng tÃ­nh tiá»n
- âœ… LÆ°u vÃ o database Ä‘Ãºng
- âœ… Hiá»ƒn thá»‹ logs theo tab

### Should Have
- âœ… Camera capture trÃªn mobile
- âœ… Image preview trÆ°á»›c upload
- âœ… Responsive design
- âœ… Loading states
- âœ… Error handling

### Nice to Have
- ğŸ“Š Thá»‘ng kÃª chi phÃ­
- ğŸ“ˆ Biá»ƒu Ä‘á»“ tiÃªu thá»¥
- ğŸ”” Nháº¯c nhá»Ÿ báº£o dÆ°á»¡ng
- ğŸ“„ Export bÃ¡o cÃ¡o

## ğŸ“ Implementation Notes

### 1. GiÃ¡ NhiÃªn Liá»‡u
- LÆ°u `unit_price` vÃ o má»—i fuel log (khÃ´ng phá»¥ thuá»™c vÃ o settings)
- Settings chá»‰ dÃ¹ng Ä‘á»ƒ auto-fill giÃ¡ má»›i
- User cÃ³ thá»ƒ override giÃ¡ khi thÃªm log

### 2. áº¢nh HÃ³a ÄÆ¡n
- TÃ¹y chá»n, khÃ´ng báº¯t buá»™c
- Compress trÆ°á»›c khi upload
- Store URL trong database
- Cloudinary auto-generate thumbnails

### 3. Tab Switching
- KhÃ´ng reload data khi switch tab
- Filter client-side tá»« Ä‘Ã£ load logs
- Preserve scroll position

### 4. Mobile Camera
- Detect mobile device
- Show camera icon prominent
- Fallback to file picker

### 5. Data Migration
- Existing logs â†’ fuel_category = 'fuel'
- unit_price, total_cost = null (optional)
- receipt_image_url = null

## ğŸ”„ Future Enhancements (v2)

### Advanced Features
1. **OCR Receipt Scanning**
   - Auto extract: date, quantity, price, total
   - AI-powered recognition
   - Manual correction

2. **Price History**
   - Track giÃ¡ qua thá»i gian
   - Chart giÃ¡ cáº£ thá»‹ trÆ°á»ng
   - Alert khi giÃ¡ tÄƒng/giáº£m

3. **Statistics Dashboard**
   - Chi phÃ­ theo thÃ¡ng/nÄƒm
   - Efficiency metrics
   - Cost per km
   - Consumption trends

4. **Maintenance Reminders**
   - Based on odometer
   - Based on time
   - Custom intervals

5. **Multi-vehicle Comparison**
   - Cost comparison
   - Efficiency comparison
   - Best performer

6. **Export & Reports**
   - PDF reports
   - Excel export
   - Email reports
   - Share with accountant

### Integration Ideas
- Link vá»›i expense tracking
- Sync vá»›i vehicle maintenance
- Connect vá»›i trip logs
- Tax deduction calculator

---

## ğŸ“‹ Checklist Before Starting

- [ ] Backup database
- [ ] Test Cloudinary credentials
- [ ] Review current fuel_logs schema
- [ ] Prepare test images
- [ ] Setup local environment
- [ ] Read through entire plan

## ğŸš€ Ready to Implement!

**Estimated Total Time:** 6-7 hours
**Priority:** High
**Difficulty:** Medium-High
**Dependencies:** Supabase, Cloudinary

---

**Created:** 2026-01-05 00:43
**Status:** âœ… Plan Complete, Ready for Implementation
**Next Step:** Phase 1 - Database Migration
